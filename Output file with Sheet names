import os
from openpyxl import load_workbook, Workbook

# Define the input and output folders
input_folder = 'Extracted Data/VRU Headform - Prediction tables'
output_folder = 'Extracted Data/VRU Headform - Color-wise graphs'

# Ensure the output folder exists
os.makedirs(output_folder, exist_ok=True)

# Process each Excel file in the input folder
for file_name in os.listdir(input_folder):
    if file_name.endswith('.xlsx'):
        # Load the input Excel file
        input_file_path = os.path.join(input_folder, file_name)
        workbook = load_workbook(input_file_path)

        # Get the first sheet and the sheet names from the second column
        first_sheet = workbook.active
        sheet_names = [cell.value for cell in first_sheet['B'] if cell.value]

        # Create a new workbook for the output
        output_workbook = Workbook()
        output_file_path = os.path.join(output_folder, file_name)

        # For each name in the sheet_names, create a new sheet and add data
        for name in sheet_names:
            sheet = output_workbook.create_sheet(title=name)
            sheet.append(["Car Name", "Values"])
            for sheet_name in workbook.sheetnames:
                sheet.append([sheet_name, ""])

        # Remove the default sheet created by openpyxl
        if 'Sheet' in output_workbook.sheetnames:
            del output_workbook['Sheet']

        # Save the output workbook
        output_workbook.save(output_file_path)

print("Processing complete.")
